*** Settings ***
Library           ../../../../../Python27/Lib/site-packages/robot/libraries/Collections.py
Library           ../MyPython/ming/Mobile.py
Resource          abstract.txt
Resource          desire_z.txt
Resource          nexus_5.txt
Library           Selenium2Library
Library           ../MyPython/ming/Custom_Library.py

*** Variables ***
${infinite}       10000

*** Test Cases ***
test
    Enter App    Settings
    Click On    text=Wi‑Fi
    Turn On Wifi
    Disconnect All
    Connect To    IAT

test_time
    Click On    text=0
    Click On    text=1

test_watcher
    ${watcher_list}    List All Watchers
    Register Click Watcher    test_watcher    text=Apps    resourceId=com.android.deskclock:id/analog_appwidget
    Register Click Watcher    test_watcher_1    text=Apps    resourceId=com.android.deskclock:id/analog_appwidget
    Register Click Watcher    test_watcher_2    text=Apps    resourceId=com.android.deskclock:id/analog_appwidget
    ${watcher_list}    List All Watchers
    Remove Watchers    test_watcher
    ${watcher_list}    List All Watchers
    Remove Watchers
    ${watcher_list}    List All Watchers
    Log    OK
    Mobile.Sleep    30000

test_change_ssid
    Turn Off AP
    Turn On AP

switch_camera_lens_position
    ${linearLayout}    Get Object    className=android.widget.LinearLayout    index=2
    ${info_dict}    get_info_of_object    ${linearLayout}
    ${chileCount}    Get From Dictionary    ${info_dict}    chileCount
    ${chileCount}    Evaluate    int(${chileCount})-1
    ${btn}    call    ${linearLayout}    child    instance=${chileCount}    className=android.widget.ImageView
    call    ${btn}    click

launch_google_play_without_user_keyword
    Mobile.Press Home
    ${view}    Mobile.Get Object    className=android.view.View    index=4
    ${all_apps_button}    Mobile.Call    ${view}    child    className=android.widget.TextView    index=2
    Mobile.Call    ${all_apps_button}    click
    Mobile.Click On    description=Shop
    ${play_store_text}    Mobile.Get Object    text=Play Store
    ${is_play_store_text_exist}    Mobile.Wait For Exists    ${play_store_text}    5000
    Should Be True    ${is_play_store_text_exist}    Play Store Text does not exist.

launch_google_play_with_user_keyword
    Mobile.Press Home
    enter_all_apps
    enter_google_play_store
    verify_google_play_text

resource_test
    Import Resource    ${CURDIR}${/}nexus_5.txt
    ${resource_name}    Set Variable    nexus_5
    log    ${resource_name}.enter_app
    desire_z.enter_app    b
    等

test_type
    type    中文你好

dropbox_test
    Install    C:${/}Users${/}YuMing${/}Documents${/}GitHub${/}furry-ironman${/}RF_uiautomator${/}com.dropbox.android_2.4.0.2.apk
    enter_all_apps
    Uninstall    com.dropbox.android

web_test
    Comment    Set Selenium Speed    1s
    Open Browser    https://www.dropbox.com/    firefox
    Click Link    /login
    Input Text    id=login_email    lym060@gmail.com
    Input Password    id=login_password    ginobili060
    Unselect Checkbox    id=remember_me
    Click Button    id=login_submit
    Wait Until Page Contains Element    //a[text()="Camera Uploads"]    5s
    Comment    ${list_items}    Get List Items    id=browse-files
    ${list_items}    Get Value    //a[text()="Camera Uploads"]
    Click Element    //a[text()="Camera Uploads"]
    Wait Until Page Contains Element    //a[text()="2014-01-06 23.24.55.jpg"]    10s
    Page Should Contain Element    //a[text()="2014-01-06 23.24.55.jpg"]    The photo does not exist.

Google Play Test
    Install App
    Change Ssid    WIFI_IS_OFF
    Verify Install Success

*** Keywords ***
z_open_screen_lock
    Mobile.Swipe    240    560    450    560

enter_all_apps
    ${view}    Mobile.Get Object    className=android.view.View    index=4
    ${all_apps_button}    Mobile.Call    ${view}    child    className=android.widget.TextView    index=2
    Mobile.Call    ${all_apps_button}    click

enter_google_play_store
    Mobile.Click On    description=Shop

verify_google_play_text
    ${play_store_text}    Mobile.Get Object    text=Play Store
    ${is_play_store_text_exist}    Mobile.Wait For Exists    ${play_store_text}    5000
    Should Be True    ${is_play_store_text_exist}    Play Store Text does not exist.
    [Return]    ${is_play_store_text_exist}

Enter App
    [Arguments]    ${app}
    Press Home
    ${info_list}    Get Info
    ${current_package}    Get From Dictionary    ${info_list}    currentPackageName
    Should Be Equal As Strings    com.android.launcher3    ${current_package}
    Click On    text=Apps
    ${page_indactor}    Get Object    resourceId=com.android.launcher3:id/page_indicator
    ${page_indactor_info}    Get Info Of Object    ${page_indactor}
    Log Dictionary    ${page_indactor_info}
    ${page_count}    Get From Dictionary    ${page_indactor_info}    chileCount
    : FOR    ${index}    IN RANGE    ${page_count}
    \    ${app_obj}    Get Object    text=${app}
    \    ${is_app_exist}    Wait For Object Exists    ${app_obj}
    \    ${view}    Get Object    resourceId=com.android.launcher3:id/apps_customize_pane_content
    \    Run Keyword If    ${is_app_exist}    Run Keywords    Call    ${app_obj}    click
    \    ...    AND    Exit For Loop    ELSE    Swipe Left    ${view}

Enter Game Category
    ${game_text_view}    Get Object
    Wait For Exists    5000    resourceId=com.android.vending:id/li_title
    Click On    resourceId=com.android.vending:id/li_title

Enter Top Free
    ${top_free_text_view}    Get Object    text=TOP FREE
    Wait For Exists    ${top_free_text_view}    5000
    Click On    text=TOP FREE

Click First Item
    ${view}    Get Object    resourceId=com.android.vending:id/bucket_items
    Wait For Exists    ${view}    5000
    Click On    resourceId=com.android.vending:id/bucket_items

Click Install
    ${install_button}    Get Object    resourceId=com.android.vending:id/buy_button
    Wait For Exists    ${install_button}    5000
    Click On    resourceId=com.android.vending:id/buy_button

Register Dialog Watcher
    ${download_large_app_condition_dict}    Create Dictionary    text    Downloading a large app
    ${proceed_button_attribtute_dict}    Create Dictionary    text    Proceed
    register_click_watcher    test_watcher    ${proceed_button_attribtute_dict}    ${download_large_app_condition_dict}

Click Accept Button
    ${accept_button}    Get Object    text=ACCEPT
    Wait For Exists    ${accept_button}    5000
    Click On    text=ACCEPT

Verify Install Success
    ${open_button}    Get Object    text=OPEN
    ${install_complete}    Wait For Exists    ${open_button}    500000
    Should Be True    ${install_complete}    Install Fail

Click Connect Button
    ${connect_button}    Get Object    text=Connect
    ${connect_button_info}    Get Info Of Object    ${connect_button}
    ${enabled_info}    Get From Dictionary    ${connect_button_info}    enabled
    Should Be True    ${enabled_info}    Connect button is not enabled
    Click On    text=Connect

Turn On Wifi
    ${switch}    Get Object    className=android.widget.Switch
    ${switch_info}    Get Info Of Object    ${switch}
    ${is_checked}    Get From Dictionary    ${switch_info}    checked
    Run Keyword Unless    ${is_checked}    Click On    className=android.widget.Switch
    ${switch_info}    Get Info Of Object    ${switch}
    ${is_checked}    Get From Dictionary    ${switch_info}    checked
    Should Be True    ${is_checked}    The Wifi should be On

Turn Off AP
    Change Ssid    WIFI_IS_OFF

Turn On AP
    Change Ssid    IAT_OFF

Install App
    Wakeup The Device
    Enter App    Play Store
    Enter Game Category
    Enter Top Free
    Click First Item
    Click Install
    Register Dialog Watcher
    Click Accept Button

Disconnect All
    : FOR    ${i}    IN RANGE    ${infinite}
    \    ${is_connected_exist}    Wait For Exists    5000    text=Connected
    \    Run Keyword If    ${is_connected_exist}    Run Keywords    Click On    text=Connected    AND
    \    ...    Click On    text=Forget    ELSE    Exit For Loop

Connect To
    [Arguments]    ${access_point_name}
    ${list_view}    Get Object    className=android.widget.ListView
    Scroll To Vertically    ${list_view}    text=${access_point_name}
    Click On    text=${access_point_name}
    ${is_correct_access_point}    Wait For Exists    text=${access_point_name}
    Should Be True    ${is_correct_access_point}    Click on wrong access point
    ${is_pwd_exist}    Wait For Exists    text=Password
    Run Keyword If    ${is_pwd_exist}    Run Keywords    Set Text    smart@inhon    resourceId=com.android.settings:id/password    AND
    ...    Press Back    AND    Click Connect Button
